router.get("/:pageNumber?", async (req, res) => {
    let pageNumber = req.params.pageNumber;
    if(!pageNumber) {
        pageNumber = 1;
    }
    
    let limit = 3;
    let skip = (pageNumber - 1) * limit;
    let products = await Product.find().limit(limit).skip(skip);
    let productCount = await Product.countDocuments();

    res.render("homepage",  {title:"Homepage", products, pageNumber, productCount})
})



router.get('/cart', checkSessAuth, async (req, res) => {
    const userId = req.session.user.id;
    try {
        const cartItems = await Cart.find({ userId }).populate('productId');
        res.send( { success: true, cartItems });
    } catch (err) {
        console.error('Server error:', err);
        res.status(500).json({ success: false, message: 'Server error' });
    }
});
